;----------------------------------
; Southern Cross ALED - ARGB  board 
;----------------------------------
;
; Craig RS Jones	Dec 2024
;
; displays an animated pacman ghost on a 8 x 8 ARGB Matrix
;
;
shifter	.equ	10h	;ALED board I/O Address

	.org	2000h

start

	ld	hl,ghost1
	ld	b,64
	call	arrayw
	call	framedelay

	ld	hl,ghost2
	ld	b,64
	call	arrayw
	call	framedelay

	ld	hl,ghost3
	ld	b,64
	call	arrayw
	call	framedelay

	ld	hl,ghost4
	ld	b,64
	call	arrayw
	call	framedelay
	jp	start


;750 millisecond frame rate
framedelay
	ld	b,250
	call	msdelay
	ld	b,250
	call	msdelay
	ld	b,250
	call	msdelay
	ret

ResetDelay
	ld	b,$10
ResetDelay1	nop
	djnz	ResetDelay1
	ret
;-------------------------
; write 8x8 array to ARGBs
;-------------------------
; B = 64 individual AGRBs
; HL = points to 64 x 3 byte array
arrayw	
	ld	a,(hl)	;green
	inc	hl

	out	(shifter),a	;output green
	nop
	nop
	nop
	nop

	ld	a,(hl)	;red
	inc	hl

	out	(shifter),a	;output red
	nop
	nop
	nop
	nop

	ld	a,(hl)	;blue
	inc	hl

	out	(shifter),a	;output blue
	nop
	nop
	nop
	nop
	
	djnz	arrayw
	call	ResetDelay
	ret
;-------------
; second delay
;-------------
; one second delay
;
; entry : b = 1 to 255 seconds
; exit  : b = 0
;
sdelay
sdelay1	push	bc
	ld	b,10	;10 x 100ms delay
sdelay2	push	bc
	ld	b,100	;100ms delay
	call	msdelay
	pop	bc
	djnz	sdelay2
	pop	bc
	djnz	sdelay1
	ret
;------------------
; millisecond delay
;------------------
; approx. 1 millisecond delay
; 
; entry : b = 1 to 255 milliseconds
; exit  : b = 0
;
msdelay	push	bc	;11t
	ld	b,233	;7t
msdel1	nop	;4t
	djnz	msdel1	;nz=13t,z=8t
	pop	bc	;10t
	djnz	msdelay	;nz=13t,z=8t
	ret	;10t

;
; RGB888 ghost animation frames, 4 frames x 64 ARGB LEDs (WS2812B native order GRB) 
;
ghost1
	.db	$00, $00, $00, $00, $00, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00, $00, $00, $00, $00, $00, $00
	.db	$00, $00, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00, $00, $00, $00
	.db	$00, $20, $00, $00, $20, $00, $20, $20, $20, $20, $20, $20, $00, $20, $00, $20, $20, $20, $20, $20, $20, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $20, $20, $20, $00, $00, $00, $00, $20, $00, $20, $20, $20, $00, $00, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $00, $00, $00, $20, $00, $00, $00, $00, $00, $20, $00, $00, $00, $00, $22, $20, $00, $00, $00, $00
ghost2
	.db	$00, $00, $00, $00, $00, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00, $00, $00, $00, $00, $00, $00
	.db	$00, $00, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00, $00, $00, $00
	.db	$00, $20, $00, $00, $20, $00, $20, $20, $20, $20, $20, $20, $00, $20, $00, $20, $20, $20, $20, $20, $20, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $20, $20, $20, $00, $00, $00, $00, $20, $00, $20, $20, $20, $00, $00, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $00, $00, $00, $20, $00, $00, $00, $00, $00, $20, $00, $00, $00, $00, $00, $20, $00, $00, $00, $00, $22, $20, $00
ghost3
	.db	$00, $00, $00, $00, $00, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00, $00, $00, $00, $00, $00, $00
	.db	$00, $00, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00, $00, $00, $00
	.db	$00, $20, $00, $00, $20, $00, $20, $20, $20, $20, $20, $20, $00, $20, $00, $20, $20, $20, $20, $20, $20, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $00, $00, $20, $20, $20, $00, $20, $00, $00, $00, $00, $20, $20, $20, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $00, $00, $00, $20, $00, $00, $00, $00, $00, $20, $00, $00, $00, $00, $22, $20, $00, $00, $00, $00
ghost4
	.db	$00, $00, $00, $00, $00, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00, $00, $00, $00, $00, $00, $00
	.db	$00, $00, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00, $00, $00, $00
	.db	$00, $20, $00, $00, $20, $00, $20, $20, $20, $20, $20, $20, $00, $20, $00, $20, $20, $20, $20, $20, $20, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $00, $00, $20, $20, $20, $00, $20, $00, $00, $00, $00, $20, $20, $20, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $00, $20, $00, $22, $20, $00, $22, $20, $00
	.db	$00, $00, $00, $00, $20, $00, $00, $00, $00, $00, $20, $00, $00, $00, $00, $00, $20, $00, $00, $00, $00, $22, $20, $00

	.end